<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>

    <!-- Imports the css, bootstrap, and firebase modules -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="./css/styles.css" type="text/css">
    <script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-firestore.js"></script>
    <script src="./js/scripts.js" type="text/javascript"></script>
</head>

<body>
    <!-- header -->
    <div class="jumbotron header-footer-div header-div">
        <section class="text-center align-center-up">
            <h2 class="head-text">Assignment Details</h2>
        </section>
    </div>

    <!-- content -->

    <div class="form-container page-content">

        <div class="row">
            <div class="col-25">
                <label>Mark as complete:</label>
            </div>
            <input id="completeCheckBox" type="checkbox" class="col-75" style="transform:scale(2)">
        </div>

        <div class="row">
            <!-- the course row -->

            <div class="col-25">
                <label>Course:</label>
            </div>
            <p id="courseBox" class="col-75"></p>
        </div>


        <div class="row">
            <!-- the Assignment name row -->

            <div class="col-25">
                <label>Assignment Name:</label>
            </div>
            <p id="assignmentNameBox" class="col-75"></p>
        </div>


        <div class="row">
            <!-- the Due date row -->

            <div class="col-25">
                <label>Due Date:</label>
            </div>
            <p id="dueDateBox" class="col-75"></p>
        </div>


        <div class="row">
            <!-- the Due time row -->

            <div class="col-25">
                <label>Due Time:</label>
            </div>
            <p id="dueTimeBox" class="col-75"></p>
        </div>


        <div class="row">
            <!-- the D2L Link row -->

            <div class="col-25">
                <label>D2L Link:</label>
                <a id="d2lLinkBox" class="glyphicon glyphicon-link align-center-down" target="_blank"></a>
            </div>
        </div>


        <div class="row">
            <!-- the Instructor name row -->

            <div class="col-25">
                <label>Instructor name:</label>
            </div>
            <p id="instructorNameBox" class="col-75"></p>
        </div>


        <div class="row">
            <!-- the INstrucotr Email row -->

            <div class="col-25">
                <label>Instructor Email:</label>
            </div>
            <p id="instructorEmailBox" class="col-75"></p>
        </div>

        <hr>


        <div class="row">
            <!-- the Instructions row -->

            <div class="col-25">
                <label>Instructions:</label>
            </div>
            <p id="instructionsBox" class="col-75"></p>
        </div>


        <div class="row">
            <!-- the Additional info row -->

            <div class="col-25">
                <label>Additional Information:</label>
            </div>
            <p id="additionalInformationBox" class="col-75"></p>
        </div>
    </div>


    <!-- footer containing the buttons -->
    <div class="jumbotron footer-div header-footer-div">
        <div class="row">
            <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 text-center">
                <a class="btn btn-warning foot-text" id="listButton">List</a>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 text-center">
                <a class="btn btn-warning foot-text" id="calendarButton">Calendar</a>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 text-center">
                <a class="btn btn-warning foot-text" id="editButton">Edit</a>
            </div>
        </div>
    </div>

    <!--load details-->
    <script>
        loadAssignmentDetails(sessionStorage.needsDetails);

        // loads the assingments upon the page loading.

        function loadAssignmentDetails(assignmentId) {
            let assignmentInstance = getElementByIdByCollectionFromLocStorage(assignmentId, 'assignmentList');
            let instructorInstance = getElementByIdByCollectionFromLocStorage(assignmentInstance.instructorID, 'instructorsList');
            document.getElementById('assignmentNameBox').innerHTML = assignmentInstance.name;
            document.getElementById('courseBox').innerHTML = assignmentInstance.course;
            document.getElementById('dueDateBox').innerHTML = assignmentInstance.dueDate;
            document.getElementById('dueTimeBox').innerHTML = assignmentInstance.dueTime;
            document.getElementById('d2lLinkBox').href = assignmentInstance.d2lLink;
            document.getElementById('instructorNameBox').innerHTML = instructorInstance.name;
            document.getElementById('instructorEmailBox').innerHTML = instructorInstance.email;
            document.getElementById('instructionsBox').innerHTML = assignmentInstance.instructions;
            document.getElementById('additionalInformationBox').innerHTML = assignmentInstance.additionalInformation;
            let currentUser = JSON.parse(localStorage.user);
            if (currentUser.completedAssignments.includes(assignmentId)){
                document.getElementById('completeCheckBox').checked = "true";
            }
        }
    </script>

    <!-- event handlers -->

    <script>
        document.getElementById('completeCheckBox').onclick= completeCBHandler;
        document.getElementById('editButton').onclick = editButtonClickHandler;
        document.getElementById('calendarButton').onclick = calendarButtonClickHandler;
        document.getElementById('listButton').onclick = listButtonClickHandler;

        // handles the button for editing assingments.
        function editButtonClickHandler() {
            sessionStorage.previousPage = "./details.html";
            window.location.href = "./addasignment.html";
        }

        // handles the button for the calendar page
        function calendarButtonClickHandler() {
            sessionStorage.needsDetails = '';
            sessionStorage.previousPage = "./details.html";
            window.location.href = "./calendar.html"
        }

        // handles the button for list page.
        function listButtonClickHandler() {
            sessionStorage.needsDetails = '';
            sessionStorage.previousPage = "./details.html";
            window.location.href = href = "./main.html";
        }

        function completeCBHandler(){
            let CB = document.getElementById('completeCheckBox');
            if (CB.checked){
                addToComplete(sessionStorage.needsDetails);
            }else{
                removeFromCompleted(sessionStorage.needsDetails);
            }
        }

        function addToComplete(assignmentID) {
            let currentUser = JSON.parse(localStorage.user);
            currentUser.completedAssignments.push(assignmentID);
            sendUserToDB(currentUser);
            sessionStorage.loadedUser = "false";
            localStorage.currentUser = JSON.stringify(user);
        }

        function removeFromCompleted(assignmentID){
            let currentUser = JSON.parse(localStorage.user);
            delete currentUser.completedAssignments[currentUser.completedAssignments.indexOf(assignmentID)];
            sendUserToDB(currentUser);
            sessionStorage.loadedUser = "false";
            localStorage.currentUser = JSON.stringify(user);
        }
    </script>
</body>

</html>