<!DOCTYPE html>
<html>

<head>
    <title>List Page</title>
    <meta lang="english">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="./css/styles.css" type="text/css">
    <script src="./js/classes.js"></script>
</head>

<body>
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-app.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
 https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-firestore.js"></script>

    <script>
        // Your web app's Firebase configuration
        var firebaseConfig = {
            apiKey: "AIzaSyA_-CQ7oIjLIeTU8B05p8lD-UbOJ9MXm_Y",
            authDomain: "team-aka.firebaseapp.com",
            databaseURL: "https://team-aka.firebaseio.com",
            projectId: "team-aka",
            storageBucket: "team-aka.appspot.com",
            messagingSenderId: "192089508874",
            appId: "1:192089508874:web:15181dc2fc7a40725ce3f3"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        var db = firebase.firestore();
    </script>
    <!-- header -->
    <div class="jumbotron header-footer-div header-div">

        <div class="col-lg-2 col-md-2 col-sm-2 col-xs-2"></div>

        <section class="col-lg-8 col-md-8 col-sm-8 col-xs-8 text-center align-center-up">
            <h2 class="head-text-list">Your List</h2>
        </section>

        <div class="col-lg-2 col-md-2 col-sm-2 col-xs-2 text-center align-center-up">
            <a class="btn btn-default" href="###########"><span class="glyphicon glyphicon-user"></span></a>
        </div>
    </div>
    <!-- content -->
    <div class="container page-content">
        <div class="row section-header section-item">

            <p class="col-lg-4 col-md-4 col-sm-4 col-xs-4  listText addMargin"> Due Date</p>
            <p class="col-lg-6 col-md-6 col-sm-6 col-xs-6  listText addMargin"> Assignment Name</p>
            <p class="col-lg-2 col-md-2 col-sm-2 col-xs-2 text-right listText addMargin"> course</p>
        </div>
        <div id="listContainer" class='container-flow'>

        </div>

    </div>
    <!-- footer -->
    <div class="jumbotron footer-div header-footer-div">
        <div class=" row justified-content-center">
            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 text-center">
                <a href="./calendar.html" class="btn headText">Calendar</a>
            </div>
            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 text-center">
                <a href="./addasignment.html" class="btn headText">Add</a>
            </div>
        </div>
    </div>


    <script>
        function buildListRow(assignmentInstance) {

            // Build the main container
            let listRow = buildRow(assignmentInstance.ID);

            //build course name
            let courseNameCol = buildCourseNameCol(assignmentInstance.courseName);

            // build assignmentName
            let assignmentNameCol = buildAssignmentNameCol(assignmentInstance.assignmentName);

            // Build due date
            let dueDateCol = buildDueDateCol(assignmentInstance.dueDate)


            // put it all together
            listRow.appendChild(dueDateCol);
            listRow.appendChild(assignmentNameCol);
            listRow.appendChild(courseNameCol);
            document.getElementById('listContainer').appendChild(listRow);
        }

        function buildRow(assignmentId) {
            // Build a col of auto span
            let listRow = document.createElement('div');
            listRow.id = assignmentId;
            listRow.className = "section-item row list-row section-item";
            return listRow;
        }

        function buildCourseNameCol(courseName) {
            let courseNameCol = document.createElement('div');
            courseNameCol.className = "col-lg-2 col-md-2 col-sm-2 col-xs-2 text-right";
            courseNameCol.innerHTML = "<p class='list-course-name list-text'>" + courseName + "</p>";
            return courseNameCol;
        }

        function buildAssignmentNameCol(assignmentName) {
            let assignmentNameCol = document.createElement('div');
            assignmentNameCol.className = "col-lg-6 col-md-6 col-sm-6 col-xs-6 text-left";
            assignmentNameCol.innerHTML = "<p class='list-assignment-name list-text'>" + assignmentName + "</p>";
            return assignmentNameCol;
        }

        function buildDueDateCol(dueDate) {
            let dueDateCol = document.createElement('div');
            dueDateCol.className = "col-lg-4 col-md-4 col-sm-4 col-xs-4 text-left";
            dueDateCol.innerHTML = "<p class='list-due-date list-text'>" + dueDate + "</p>";
            return dueDateCol
        }

<<<<<<< HEAD
        testAssignment = new assignment('COMM 1930', 'Top secret', 'November 7, 2019', 'https://learn.bcit.ca/d2l/lms/dropbox/user/folder_submit_files.d2l?db=197227&grpid=0&isprv=0&bp=' 
        + '&ou=581646', '', '', '', '');
        testAssignment.setID();
        testAssignment.checkDBforID()


        //buildListRow(testAssignment);
=======
        class assignment {
            constructor(course, assignmentName, dueDate, D2LLink, instructions, additionalInstructions, instructorID) {
                this.course = course;
                this.assignment = assignmentName;
                this.dueDate = dueDate;
                this.D2LLink = D2LLink;
                this.instructions = instructions;
                this.additionalInstructions = additionalInstructions;
                this.instructorID = instructorID;
            }
        }

        function addAssignment(assignment, idName) {
            db.collection("assignments").doc(idName).set({
                'course': assignment.course,
                'name': assignment.assignment,
                'due date': assignment.dueDate,
                'D2L Link': assignment.D2LLink,
                'instructions': assignment.instructions,
                'additional information': assignment.additionalInstructions,
                'instructor': assignment.instructorID
            })
        }

        let assignment1 = new assignment('COMP-1712', 'Name', 'Date', 'Link', 'Instructions', 'Additional Instructions', 'Instructor');
        let assignment2 = new assignment('COMP-1113', 'Name', 'Date', 'Link', 'Instructions', 'Additional Instructions', 'Instructor');

        addAssignment(assignment1, 'Biz Analysis');
        addAssignment(assignment2, 'Math');

        let assignmentList = [];

>>>>>>> 4545f3ca257b87d76ab2e0474d26a877c49ddffc
        db.collection("assignments").get().then(function (querySnapshot) {
            querySnapshot.forEach(function (doc) {
                // doc.data() is never undefined for query doc snapshots
                assignmentDetails = doc.data();
                newAssignment = new assignment(assignmentDetails['course'], assignmentDetails['name'], assignmentDetails['due date'], assignmentDetails['D2L Link'], assignmentDetails['Instructions'], assignmentDetails['additional information'], assignmentDetails['instructor']);
<<<<<<< HEAD
                buildListRow(newAssignment);
            });
        });

=======
                window.localStorage.setItem(doc.id, JSON.stringify(newAssignment));
                buildListRow(newAssignment);
                console.log(JSON.parse(window.localStorage.getItem(doc.id)));
            });
        });


>>>>>>> 4545f3ca257b87d76ab2e0474d26a877c49ddffc
        function movefirebase() {
            document.getElementById('firebaseui-auth-container').style.top = "45%";
        }
    </script>
</body>

</html>